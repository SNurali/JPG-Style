{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
     <link rel="icon" href="https://smartwash.uz/favicon.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="yandex-verification" content="04adbf52a5b45806" />
    <meta name="author" content="JPG-Style Smart Wash">

    <title>{% block title %}JPG-Style Smart Wash — автохимия и уход за авто{% endblock %}</title>
    <meta name="description" content="{% block description %}Интернет-магазин автохимии в Ташкенте. Чернители, шампуни, сухой туман. Доставка по Узбекистану.{% endblock %}">
    <meta name="google-site-verification" content="CtD-glnfa6j3Qxar6OPVrBx3oqW-5KbUuXZ6eeJU9Ls" />
    <meta name="keywords" content="{% block keywords %}автохимия, шампунь для авто, чернитель резины, Ташкент, SmartWash, сухой туман{% endblock %}">

    <link rel="canonical" href="{{ request.build_absolute_uri }}">

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.build_absolute_uri }}">
    <meta property="og:title" content="{% block og_title %}JPG-Style Smart Wash{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Автохимия и средства для ухода за автомобилем в Ташкенте{% endblock %}">
    {% block og_image %}
        {% if og_image %}
            <meta property="og:image" content="{{ og_image }}">
        {% else %}
            <meta property="og:image" content="https://smartwash.uz/static/img/og-image.jpg">
        {% endif %}
    {% endblock %}

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="{{ request.build_absolute_uri }}">
    <meta name="twitter:title" content="{% block twitter_title %}JPG-Style Smart Wash{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}Средства для ухода за авто в Узбекистане{% endblock %}">
    {% block twitter_image %}
        {% if og_image %}
            <meta name="twitter:image" content="{{ og_image }}">
        {% else %}
            <meta name="twitter:image" content="https://smartwash.uz/static/img/og-image.jpg">
        {% endif %}
    {% endblock %}

    <!-- Hreflang -->
    <link rel="alternate" hreflang="ru" href="{{ request.build_absolute_uri }}" />
    <link rel="alternate" hreflang="x-default" href="https://smartwash.uz/" />

    <!-- Favicon -->
    <link rel="icon" href="{% static 'img/favicon.svg' %}" type="image/x-icon">
    <link rel="apple-touch-icon" href="{% static 'img/apple-touch-icon.png' %}">

    <!-- CSS -->
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "JPG-Style Smart Wash",
        "url": "https://smartwash.uz/",
        "logo": "https://smartwash.uz/static/img/logo.svg",
        "description": "Интернет-магазин автохимии и автоухода",
        "address": {
            "@type": "PostalAddress",
            "streetAddress": "ул. 8а, дом 3",
            "addressLocality": "Ташкент",
            "addressRegion": "Сергелийский район",
            "postalCode": "100085",
            "addressCountry": "UZ"
        },
        "contactPoint": {
            "@type": "ContactPoint",
            "telephone": "+998501040026",
            "contactType": "sales",
            "email": "smartwash1986@gmail.com"
        },
        "sameAs": [
            "https://www.instagram.com/smartwash.uz/",
            "https://t.me/smartwashuz",
            "https://facebook.com/smartwashuz"
        ]
    }
    </script>

    <!-- Google Tag Manager -->
    <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
    var f=d.getElementsByTagName(s)[0], j=d.createElement(s), dl=l!='dataLayer'?'&l='+l:'';
    j.async=true; j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;
    f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-T5P2DN9');
    </script>

    <!-- Yandex.Metrika -->
    <script type="text/javascript">
    (function(m,e,t,r,i,k,a){
       m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
       m[i].l=1*new Date();
       for (var j = 0; j < document.scripts.length; j++) {
           if (document.scripts[j].src === r) { return; }
       }
       k=e.createElement(t),a=e.getElementsByTagName(t)[0],
       k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(103323516, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true,
        ecommerce:"dataLayer"
    });
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/103323516" style="position:absolute; left:-9999px;" alt="" /></div></noscript>

</head>
<body>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-T5P2DN9"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary mb-4 fixed-top">
    <div class="container">
        <a class="navbar-brand" href="{% url 'home' %}">
            <svg class="logo-svg" xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100">
              <circle cx="50" cy="55" r="45" fill="white" />
              <rect x="35" y="55" width="30" height="15" rx="3" ry="3" fill="#666666" />
              <circle cx="40" cy="75" r="5" fill="#666666" />
              <circle cx="60" cy="75" r="5" fill="#666666" />
              <rect x="38" y="58" width="10" height="6" fill="#FFFFFF" />
              <rect x="52" y="58" width="10" height="6" fill="#FFFFFF" />
            </svg>
            JPG-Style Smart Wash
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
            <ul class="navbar-nav">
                <li class="nav-item"><a class="nav-link" href="{% url 'home' %}">Главная</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'catalog' %}">Каталог</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'contacts' %}">Контакты</a></li>
                <li class="nav-item"><a class="nav-link" href="{% url 'autochemistry_list' %}">Мир автохимии</a></li>
            </ul>
        </div>
    </div>
</nav>

<!-- Хлебные крошки -->
<nav aria-label="breadcrumb" class="mb-4 container">
    <ol class="breadcrumb">
        {% block breadcrumbs %}
        <li class="breadcrumb-item"><a href="{% url 'home' %}">Главная</a></li>
        {% endblock %}
    </ol>
</nav>

<div class="container mt-5 pt-4">{% block content %}{% endblock %}</div>

<!-- Кнопка корзины -->
<a href="{% url 'cart' %}" class="floating-cart">
    <div class="cart-icon-wrapper">
        <i class="fas fa-shopping-cart"></i>
        {% with request.session.cart|length as cart_count %}
            {% if cart_count > 0 %}
                <span class="cart-count">{{ cart_count }}</span>
            {% endif %}
        {% endwith %}
    </div>
</a>

<!-- Скрипты -->
<script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
<script>
    window.addEventListener('scroll', function() {
        const navbar = document.querySelector('.navbar');
        navbar.classList.toggle('scrolled', window.scrollY > 50);
    });

    document.querySelectorAll('.btn, .nav-link, .floating-cart').forEach(button => {
        button.classList.add('wave-effect');
    });

    document.addEventListener('DOMContentLoaded', function() {
        document.querySelectorAll('.quantity-plus').forEach(btn => {
            btn.addEventListener('click', function() {
                const input = this.closest('.input-group').querySelector('input');
                let val = parseInt(input.value);
                if (val < 10) input.value = val + 1;
            });
        });

        document.querySelectorAll('.quantity-minus').forEach(btn => {
            btn.addEventListener('click', function() {
                const input = this.closest('.input-group').querySelector('input');
                let val = parseInt(input.value);
                if (val > 1) input.value = val - 1;
            });
        });
    });

    function showToast(message, type = 'success') {
        const toastEl = document.createElement('div');
        toastEl.className = `toast align-items-center text-white bg-${type === 'error' ? 'danger' : 'success'} border-0 position-fixed bottom-0 end-0 m-3`;
        toastEl.setAttribute('role', 'alert');
        toastEl.setAttribute('aria-live', 'assertive');
        toastEl.setAttribute('aria-atomic', 'true');
        toastEl.innerHTML = `
            <div class="d-flex">
                <div class="toast-body">${message}</div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
        `;
        document.body.appendChild(toastEl);
        const toast = new bootstrap.Toast(toastEl);
        toast.show();
        setTimeout(() => toastEl.remove(), 5000);
    }
</script>

<style>
.floating-cart {
    position: fixed;
    bottom: 20px;
    right: 20px;
    background-color: #0d6efd;
    color: white;
    padding: 16px;
    border-radius: 50%;
    font-size: 24px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    z-index: 9999;
    transition: background-color 0.3s ease;
    text-decoration: none;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 60px;
    height: 60px;
}

.floating-cart:hover {
    background-color: #084298;
}

.cart-icon-wrapper {
    position: relative;
    width: 24px;
    height: 24px;
}

.cart-icon-wrapper i {
    font-size: 28px;
}

.cart-count {
    position: absolute;
    top: -10px;
    right: -12px;
    background-color: red;
    color: white;
    border-radius: 50%;
    min-width: 20px;
    height: 20px;
    font-size: 12px;
    line-height: 20px;
    text-align: center;
    padding: 0 6px;
    font-weight: bold;
    box-shadow: 0 0 0 2px white;
}

.quantity-plus, .quantity-minus {
    width: 40px;
}
#quantity {
    -moz-appearance: textfield;
    width: 40px;
    padding: 0.375rem;
    text-align: center;
}
#quantity::-webkit-outer-spin-button,
#quantity::-webkit-inner-spin-button {
    -webkit-appearance: none;
    margin: 0;
}
.input-group {
    width: auto;
    flex-wrap: nowrap;
}
</style>

</body>
</html>
